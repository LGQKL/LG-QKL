"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2344],{20353:function(n,e,r){r.d(e,{Z:function(){return x}});var t=r(26042),o=r(69396),c=r(99534),i=r(85893);r(67294);var s=r(7297),a=r(87379),u=r(57247),l=r(44147);function d(){var n=(0,s.Z)(["\n  0% {\n    background-position: 50% 0%;\n  }\n  50% {\n    background-position: 50% 100%;\n  }\n  100% {\n    background-position: 50% 0%;\n  }\n"]);return d=function(){return n},n}function h(){var n=(0,s.Z)(["\n      animation: "," 3s ease infinite;\n      background-size: 400% 400%;\n    "]);return h=function(){return n},n}function f(){var n=(0,s.Z)(["\n  background: ",";\n  border-radius: ",";\n  color: ",";\n  overflow: hidden;\n  position: relative;\n\n  ","\n\n  padding: 1px 1px 3px 1px;\n\n  ","\n"]);return f=function(){return n},n}function b(){var n=(0,s.Z)(["\n  width: 100%;\n  height: 100%;\n  overflow: ",";\n  background: ",";\n  border-radius: ",";\n"]);return b=function(){return n},n}var p=(0,a.F4)(d()),g=function(n){var e=n.isActive,r=n.isSuccess,t=n.isWarning,o=n.borderBackground,c=n.theme;return o||(t?c.colors.warning:r?c.colors.success:e?"linear-gradient(180deg, ".concat(c.colors.primaryBright,", ").concat(c.colors.secondary,")"):c.colors.cardBorder)},k=a.ZP.div.withConfig({componentId:"sc-eecfaa46-0"}).withConfig({componentId:"sc-62e22978-0"})(f(),g,function(n){return n.theme.radii.card},function(n){var e=n.theme,r=n.isDisabled;return e.colors[r?"textDisabled":"text"]},function(n){return n.isActive&&(0,a.iv)(h(),p)},u.Dh),v=(0,a.ZP)(l.Z).withConfig({componentId:"sc-eecfaa46-1"}).withConfig({componentId:"sc-62e22978-1"})(b(),function(n){return n.hasCustomBorder?"initial":"inherit"},function(n){var e=n.theme,r=n.background;return null!=r?r:e.card.background},function(n){return n.theme.radii.card});k.defaultProps={isActive:!1,isSuccess:!1,isWarning:!1,isDisabled:!1};var x=function(n){var e=n.ribbon,r=n.children,s=n.background,a=(0,c.Z)(n,["ribbon","children","background"]);return(0,i.jsx)(k,(0,o.Z)((0,t.Z)({},a),{children:(0,i.jsxs)(v,{background:s,hasCustomBorder:!!a.borderBackground,children:[e,r]})}))}},22344:function(n,e,r){r.r(e),r.d(e,{default:function(){return G}});var t,o,c,i,s=r(26042),a=r(10253),u=r(7297),l=r(85893),d=r(97478),h=r(52775),f=r(87379),b=r(20353),p=r(75943),g=r(44147),k=r(88896),v=r(62077),x=r(95459),m=r(921),Z=r(47568),B=r(70655),N=r(67294),y=r(28687),j=r(62621),w=r(6680),C=r(33533);function S(){var n=(0,u.Z)(['\n            query getNftMarketSubgraphHealth {\n              indexingStatusForCurrentVersion(subgraphName: "','") {\n                synced\n                health\n                chains {\n                  chainHeadBlock {\n                    number\n                  }\n                  latestBlock {\n                    number\n                  }\n                }\n              }\n            }\n          ']);return S=function(){return n},n}(_=t||(t={}))[_.OK=0]="OK",_[_.WARNING=1]="WARNING",_[_.NOT_OK=2]="NOT_OK",_[_.UNKNOWN=3]="UNKNOWN";var I=function(n){var e=(0,N.useState)({status:t.UNKNOWN,currentBlock:0,chainHeadBlock:0,latestBlock:0,blockDifference:0}),r=e[0],o=e[1];return(0,C.X)(function(e){var r;(r=(0,Z.Z)(function(){var r,c,i,s,u,l,d,h,f;return(0,B.__generator)(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,Promise.all([(0,y.request)(w.AM,(0,y.gql)(S(),n)),e?Promise.resolve(e):j.v.getBlockNumber()])];case 1:return c=(r=a.Z.apply(void 0,[b.sent(),2]))[0].indexingStatusForCurrentVersion,i=r[1],s="healthy"===c.health,u=parseInt(c.chains[0].chainHeadBlock.number),d=i-(l=parseInt(c.chains[0].latestBlock.number)),h=i-u,!s||d>200||h>200?o({status:t.NOT_OK,currentBlock:i,chainHeadBlock:u,latestBlock:l,blockDifference:d}):d>50||h>50?o({status:t.WARNING,currentBlock:i,chainHeadBlock:u,latestBlock:l,blockDifference:d}):o({status:t.OK,currentBlock:i,chainHeadBlock:u,latestBlock:l,blockDifference:d}),[3,3];case 2:return f=b.sent(),console.error("Failed to perform health check for ".concat(n," subgraph"),f),[3,3];case 3:return[2]}})}),function(){return r.apply(this,arguments)})()},[n]),r};function O(){var n=(0,u.Z)(["\n  border-radius: 8px;\n  > div {\n    border-radius: 8px;\n  }\n  user-select: none;\n"]);return O=function(){return n},n}function D(){var n=(0,u.Z)(["\n  gap: 7px;\n"]);return D=function(){return n},n}function K(){var n=(0,u.Z)(["\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  background: ",";\n"]);return K=function(){return n},n}var _,P=(0,f.ZP)(b.Z).withConfig({componentId:"sc-46961c6e-0"})(O()),W=(0,f.ZP)(p.Z).withConfig({componentId:"sc-46961c6e-1"})(D()),A=(0,f.ZP)(g.Z).withConfig({componentId:"sc-46961c6e-2"})(K(),function(n){var e=n.$color;return n.theme.colors[e]}),F=function(n){var e=n.color,r=n.label,t=n.description,o=n.currentBlock,c=n.secondRemainingBlockSync,i=n.blockNumberFromSubgraph,s=(0,h.$G)().t;return(0,l.jsxs)(g.Z,{children:[(0,l.jsxs)(W,{pb:"10px",children:[(0,l.jsx)(A,{$color:e}),(0,l.jsx)(v.Z,{children:r})]}),(0,l.jsx)(v.Z,{pb:"24px",children:t}),(0,l.jsxs)(v.Z,{children:[(0,l.jsxs)("strong",{children:[s("Chain Head Block"),":"]})," ",o]}),(0,l.jsxs)(v.Z,{children:[(0,l.jsxs)("strong",{children:[s("Latest Subgraph Block"),":"]})," ",i]}),(0,l.jsxs)(v.Z,{children:[(0,l.jsxs)("strong",{children:[s("Delay"),":"]})," ",o-i," (",c,"s)"]})]})},G=function(n){var e,r,u,f=n.subgraphName,b=n.inline,p=n.customDescriptions,Z=n.obeyGlobalSetting,B=(0,h.$G)().t,N=I(f),y=N.status,j=N.currentBlock,w=N.blockDifference,C=N.latestBlock,S=(0,a.Z)((0,m.YF)(),1)[0],O=y===t.WARNING||y===t.NOT_OK,D={delayed:{label:B("Delayed"),color:"failure",description:null!==(o=null==p?void 0:p.delayed)&&void 0!==o?o:B("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},slow:{label:B("Slight delay"),color:"warning",description:null!==(c=null==p?void 0:p.slow)&&void 0!==c?c:B("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},healthy:{label:B("Fast"),color:"success",description:null!==(i=null==p?void 0:p.healthy)&&void 0!==i?i:B("No issues with the subgraph.")}},K=w*d.hJ,_=D[y===t.NOT_OK?"delayed":y===t.WARNING?"slow":"healthy"],G=(0,k.Z)((0,l.jsx)(F,(0,s.Z)({currentBlock:j,secondRemainingBlockSync:K,blockNumberFromSubgraph:C},_)),{placement:"top"}),H=G.targetRef,R=G.tooltipVisible,$=G.tooltip;return C&&j&&((void 0===Z||Z)&&S||O)?b?(0,l.jsxs)(W,{alignItems:"center",justifyContent:"flex-end",ref:H,children:[(0,l.jsx)(A,{$color:_.color}),(0,l.jsx)(v.Z,{children:_.label}),(0,l.jsx)(x.Z,{}),R&&$]}):(0,l.jsxs)(g.Z,{position:"fixed",bottom:"calc(55px + env(safe-area-inset-bottom))",right:"5%",ref:H,"data-test":"subgraph-health-indicator",children:[R&&$,(0,l.jsx)(P,{children:(0,l.jsxs)(W,{alignItems:"center",p:"10px",children:[(0,l.jsx)(A,{$color:_.color}),(0,l.jsx)(v.Z,{children:_.label}),(0,l.jsx)(x.Z,{})]})})]}):null}}}]);