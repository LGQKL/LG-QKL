(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4169],{42379:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/voting/proposal/create",function(){return n(85812)}])},65916:function(e,t,n){"use strict";var r=n(7297),a=n(36305),c=n(85893),i=n(67294),o=n(87379),s=n(57247),d=n(37303);function l(){var e=(0,r.Z)(["\n  align-items: center;\n  color: ",";\n  display: flex;\n  justify-content: center;\n  padding-left: 4px;\n  padding-right: 4px;\n\n  "," {\n    padding-left: 8px;\n    padding-right: 8px;\n  }\n\n  "," {\n    padding-left: 16px;\n    padding-right: 16px;\n  }\n"]);return l=function(){return e},e}function u(){var e=(0,r.Z)(["\n  align-items: center;\n  display: flex;\n  flex-wrap: wrap;\n  list-style-type: none;\n\n  a {\n    color: ",";\n\n    &:hover {\n      color: ",";\n    }\n  }\n\n  ","\n"]);return u=function(){return e},e}var p=o.ZP.div.withConfig({componentId:"sc-b9c7047c-0"}).withConfig({componentId:"sc-9f0b852c-0"})(l(),function(e){return e.theme.colors.textDisabled},function(e){return e.theme.mediaQueries.sm},function(e){return e.theme.mediaQueries.md}),h=o.ZP.ul.withConfig({componentId:"sc-b9c7047c-1"}).withConfig({componentId:"sc-9f0b852c-1"})(u(),function(e){return e.theme.colors.primary},function(e){return e.theme.colors.primaryBright},s.Dh),m=(0,c.jsx)(d.Z,{color:"currentColor",width:"24px"}),x=function(e){var t,n,r=e.separator,o=e.children,s=(t=i.Children.toArray(o).filter(function(e){return(0,i.isValidElement)(e)}),n=void 0===r?m:r,t.reduce(function(e,t,r){return 0===r?(0,a.Z)(e).concat([t]):(0,a.Z)(e).concat([(0,c.jsx)(p,{"aria-hidden":!0,children:n},"separator-".concat(r)),t,])},[]));return(0,c.jsx)(h,{children:s.map(function(e,t){return(0,c.jsx)("li",{children:e},"child-".concat(t))})})};t.Z=x},85812:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eS}});var r=n(47568),a=n(14924),c=n(26042),i=n(69396),o=n(10253),s=n(70655),d=n(85893),l=n(67294),u=n(19237),p=n(21812),h=n(44147),m=n(65916),x=n(62077),f=n(32762),_=n(20353),k=n(55209),g=n(69589),b=n(70257),Z=n(75943),j=n(40735),v=n(98553),y=n(63771),C=n(29315),T=n(98913),w=n.n(T),D=n(41609),P=n.n(D),B=n(88770),I=n(96470),S=n(97119),E=n(15260),q=n(52775),M=n(44305),A=n(99534),Y=n(9198),F=n.n(Y);n(64999);var G=function(e){var t=e.inputProps,n=(0,A.Z)(e,["inputProps"]);return(0,d.jsx)(F(),(0,c.Z)({customInput:(0,d.jsx)(f.Z,(0,c.Z)({},void 0===t?{}:t)),portalId:"reactDatePicker",dateFormat:"PPP"},n))},N=n(7297),V=n(87379);function L(){var e=(0,N.Z)(["\n  .react-datepicker-wrapper,\n  .react-datepicker__input-container {\n    display: block;\n  }\n\n  .react-datepicker {\n    background: ",";\n    border-color: ",";\n    color: ",";\n    font-family: 'Kanit', sans-serif;\n  }\n\n  .react-datepicker__header {\n    background: ",";\n    border-color: ",";\n  }\n\n  .react-datepicker__current-month,\n  .react-datepicker-time__header,\n  .react-datepicker-year-header,\n  .react-datepicker__day-name,\n  .react-datepicker__day,\n  .react-datepicker__time-name {\n    color: ",";\n  }\n\n  .react-datepicker__day:hover,\n  .react-datepicker__month-text:hover,\n  .react-datepicker__quarter-text:hover,\n  .react-datepicker__year-text:hover {\n    background-color: ",";\n  }\n\n  .react-datepicker-popper[data-placement^='bottom'] .react-datepicker__triangle::before,\n  .react-datepicker-popper[data-placement^='bottom'] .react-datepicker__triangle::after {\n    border-bottom-color: ",";\n  }\n\n  .react-datepicker__day--selected,\n  .react-datepicker__day--in-selecting-range,\n  .react-datepicker__day--in-range,\n  .react-datepicker__month-text--selected,\n  .react-datepicker__month-text--in-selecting-range,\n  .react-datepicker__month-text--in-range,\n  .react-datepicker__quarter-text--selected,\n  .react-datepicker__quarter-text--in-selecting-range,\n  .react-datepicker__quarter-text--in-range,\n  .react-datepicker__year-text--selected,\n  .react-datepicker__year-text--in-selecting-range,\n  .react-datepicker__year-text--in-range {\n    background-color: ",";\n  }\n\n  .react-datepicker__day--selected:hover,\n  .react-datepicker__day--in-selecting-range:hover,\n  .react-datepicker__day--in-range:hover,\n  .react-datepicker__month-text--selected:hover,\n  .react-datepicker__month-text--in-selecting-range:hover,\n  .react-datepicker__month-text--in-range:hover,\n  .react-datepicker__quarter-text--selected:hover,\n  .react-datepicker__quarter-text--in-selecting-range:hover,\n  .react-datepicker__quarter-text--in-range:hover,\n  .react-datepicker__year-text--selected:hover,\n  .react-datepicker__year-text--in-selecting-range:hover,\n  .react-datepicker__year-text--in-range:hover {\n    background-color: ",";\n  }\n\n  .react-datepicker__day--keyboard-selected,\n  .react-datepicker__month-text--keyboard-selected,\n  .react-datepicker__quarter-text--keyboard-selected,\n  .react-datepicker__year-text--keyboard-selected {\n    background-color: ",";\n    color: #ffffff;\n  }\n\n  .react-datepicker__day--keyboard-selected:hover,\n  .react-datepicker__month-text--keyboard-selected:hover,\n  .react-datepicker__quarter-text--keyboard-selected:hover,\n  .react-datepicker__year-text--keyboard-selected:hover {\n    background-color: ",";\n    color: #ffffff;\n  }\n\n  .react-datepicker__time-container,\n  .react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box {\n    width: 120px;\n  }\n\n  .react-datepicker__header--time {\n    padding: 8px;\n  }\n\n  .react-datepicker__time-container\n    .react-datepicker__time\n    .react-datepicker__time-box\n    ul.react-datepicker__time-list\n    li.react-datepicker__time-list-item {\n    height: auto;\n    padding: 8px;\n  }\n\n  .react-datepicker__time-container\n    .react-datepicker__time\n    .react-datepicker__time-box\n    ul.react-datepicker__time-list\n    li.react-datepicker__time-list-item {\n    background-color: ",";\n\n    &:hover {\n      background-color: ",";\n    }\n  }\n\n  .react-datepicker__time-container\n    .react-datepicker__time\n    .react-datepicker__time-box\n    ul.react-datepicker__time-list\n    li.react-datepicker__time-list-item--selected {\n    color: ",";\n  }\n"]);return L=function(){return e},e}var O=V.ZP.div.withConfig({componentId:"sc-1ce524b4-0"})(L(),function(e){return e.theme.card.background},function(e){return e.theme.colors.cardBorder},function(e){return e.theme.colors.text},function(e){return e.theme.colors.input},function(e){return e.theme.colors.cardBorder},function(e){return e.theme.colors.text},function(e){return e.theme.colors.cardBorder},function(e){return e.theme.colors.cardBorder},function(e){return e.theme.colors.primary},function(e){return e.theme.colors.primaryBright},function(e){return e.theme.colors.secondary},function(e){return e.theme.colors.secondary},function(e){return e.theme.card.background},function(e){return e.theme.colors.cardBorder},function(e){return e.theme.colors.text}),H=function(){return(0,d.jsx)(O,{id:"reactDatePicker"})},R=function(e){var t=(0,q.$G)().t;return(0,d.jsx)(G,(0,c.Z)({showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:15,timeCaption:t("Time"),dateFormat:"ppp"},e))},z=n(7447),$=n(44035),Q=n(27553),X=n(11163),J=n(41664),W=n.n(J),K=n(5152),U=n.n(K),ee=n(80197),et=n(49804);function en(){var e=(0,N.Z)(["\n  color: ",";\n  display: block;\n  font-weight: 600;\n  margin-bottom: 8px;\n"]);return en=function(){return e},e}function er(){var e=(0,N.Z)(["\n  font-size: 20px;\n"]);return er=function(){return e},e}function ea(){var e=(0,N.Z)(["\n  font-size: 12px;\n  text-transform: uppercase;\n"]);return ea=function(){return e},e}var ec,ei=V.ZP.label.withConfig({componentId:"sc-408fcf5-0"})(en(),function(e){return e.theme.colors.text}),eo=(0,V.ZP)(ei).withConfig({componentId:"sc-408fcf5-1"})(er()),es=(0,V.ZP)(ei).withConfig({componentId:"sc-408fcf5-2"})(ea()),ed=function(e){var t=e.children;return(0,d.jsx)(x.Z,{color:"failure",mb:"4px",children:t})},el=function(e){var t=e.errors;return(0,d.jsx)(h.Z,{mt:"8px",children:t.map(function(e){return(0,d.jsx)(ed,{children:e},e)})})},eu=n(36305),ep=n(73955),eh=n.n(ep),em=n(89663),ex=n(81641),ef=function(e){var t=e.onRemove,n=e.onTextInput,r=(0,A.Z)(e,["onRemove","onTextInput"]),a=(0,l.useState)(!1),o=a[0],s=a[1],u=(0,l.useState)(!1),p=u[0],m=u[1],x=function(e){var t=e.currentTarget.value;s(p&&0===t.length),m(!0),n(t)};return(0,d.jsxs)(h.Z,{position:"relative",mb:"16px",children:[(0,d.jsx)(f.Z,(0,i.Z)((0,c.Z)({},r),{onChange:x,isWarning:o})),t&&(0,d.jsx)(h.Z,{position:"absolute",right:"8px",top:"0px",zIndex:30,children:(0,d.jsx)(em.Z,{variant:"text",onClick:t,children:(0,d.jsx)(ex.Z,{})})})]})},e_=function(){return{id:eh()(),value:""}},ek=function(e){var t=e.choices,n=e.onChange,r=(0,q.$G)().t,a=t.filter(function(e){return e.value.length>0}).length>=2,c=function(){n((0,eu.Z)(t).concat([e_()]))};return(0,d.jsxs)(_.Z,{children:[(0,d.jsx)(k.Z,{children:(0,d.jsx)(g.Z,{as:"h3",scale:"md",children:r("Choices")})}),(0,d.jsxs)(b.Z,{children:[t.map(function(e,a){var c=e.id,i=e.value,o=function(e){var r=(0,eu.Z)(t);r[r.findIndex(function(e){return e.id===c})].value=e,n(r)},s=function(){n(t.filter(function(e){return e.id!==c}))};return(0,d.jsx)(ef,{scale:"lg",onTextInput:o,placeholder:r("Input choice text"),value:i,onRemove:a>1?s:void 0},c)}),(0,d.jsx)(v.Z,{type:"button",onClick:c,disabled:!a,children:r("Add Choice")})]})]})},eg=n(12274),eb=n(42298),eZ=n(23855),ej=function(e,t){if(!(0,eg.default)(e)||!(0,eg.default)(t))return null;var n=(0,eb.default)(e,"yyyy-MM-dd"),r=(0,eb.default)(t,"HH:mm:ss");return(0,eZ.default)("".concat(n,"T").concat(r)).getTime()/1e3},ev=function(e,t){var n=e.name,r=e.body,a=e.choices,c=e.startDate,i=e.startTime,o=e.endDate,s=e.endTime,d=e.snapshot,l={};n||(l.name=[t("%field% is required",{field:"Title"})]),r||(l.body=[t("%field% is required",{field:"Body"})]),a.length<2&&(l.choices=[t("Please create a minimum of %num% choices",{num:2})]);var u=a.some(function(e){return!e.value});2===a.length&&u&&(l.choices=Array.isArray(l.choices)?(0,eu.Z)(l.choices).concat([t("Choices must not be empty")]):l.choices=[t("Choices must not be empty")]),(0,eg.default)(c)||(l.startDate=[t("Please select a valid date")]),(0,eg.default)(i)||(l.startTime=[t("Please select a valid time")]),(0,eg.default)(o)||(l.endDate=[t("Please select a valid date")]),(0,eg.default)(s)||(l.endTime=[t("Please select a valid time")]);var p=ej(c,i);return ej(o,s)<p&&(l.endDate=Array.isArray(l.endDate)?(0,eu.Z)(l.endDate).concat([t("End date must be after the start date")]):l.endDate=[t("End date must be after the start date")]),0===d&&(l.snapshot=[t("Invalid snapshot")]),l},ey=n(81896),eC=n(85937),eT=n(69136),ew=n(63850),eD=n(58433),eP=n(86540),eB=function(e){var t=e.block,n=e.onDismiss,r=(0,q.$G)().t,a=(0,l.useState)(!0),c=a[0],i=a[1],o=(0,eD.Z)(t,c),s=o.isLoading,u=o.total,p=o.cakeBalance,m=o.cakeVaultBalance,x=o.cakePoolBalance,f=o.poolsBalance,_=o.cakeBnbLpBalance,k=o.ifoPoolBalance,g=o.lockedCakeBalance,b=o.lockedEndTime,j=(0,ew.ZP)().theme,y=function(){i(!1),n()};return(0,d.jsx)(eC.Z,{title:r("Voting Power"),onDismiss:y,headerBackground:j.colors.gradientCardHeader,children:(0,d.jsx)(h.Z,{mb:"24px",width:["100%","100%","100%","320px"],children:s?(0,d.jsx)(Z.Z,{height:"450px",alignItems:"center",justifyContent:"center",children:(0,d.jsx)(eT.Z,{size:80})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(eP.Z,{total:u,cakeBalance:p,cakeVaultBalance:m,cakePoolBalance:x,poolsBalance:f,ifoPoolBalance:k,cakeBnbLpBalance:_,lockedCakeBalance:g,lockedEndTime:b,block:t}),(0,d.jsx)(v.Z,{variant:"secondary",onClick:n,width:"100%",mt:"16px",children:r("Close")})]})})})},eI=U()(function(){return Promise.all([n.e(3126),n.e(9980),n.e(305)]).then(n.bind(n,95521))},{loadableGenerated:{webpack:function(){return[95521]}},ssr:!1}),eS=function(){var e,t=(0,l.useState)(function(){return{name:"",body:"",choices:w()(2).map(e_),startDate:null,startTime:null,endDate:null,endTime:null,snapshot:0}}),n=t[0],T=t[1],D=(0,l.useState)(!1),A=D[0],Y=D[1],F=(0,l.useState)({}),N=F[0],V=F[1],L=(0,q.$G)().t,O=(0,C.Ge)().account,J=(0,B.Xh)(),K=(0,X.useRouter)().push,U=(0,C.QW)().signMessageAsync,en=(0,u.p)(),er=en.toastSuccess,ea=en.toastError,ec=(0,o.Z)((0,p.Z)((0,d.jsx)(eB,{block:n.snapshot})),1)[0],ei=n.name,ed=n.body,eu=n.choices,ep=n.startDate,eh=n.startTime,em=n.endDate,ex=n.endTime,ef=n.snapshot,eg=ev(n,L),eb=(e=(0,r.Z)(function(e){var t,n,r,a,o;return(0,s.__generator)(this,function(s){switch(s.label){case 0:e.preventDefault(),s.label=1;case 1:return s.trys.push([1,6,,7]),Y(!0),t=JSON.stringify((0,i.Z)((0,c.Z)({},(0,ee.GB)()),{type:I.Nl.PROPOSAL,payload:{name:ei,body:ed,snapshot:ef,start:ej(ep,eh),end:ej(em,ex),choices:eu.filter(function(e){return e.value}).map(function(e){return e.value}),metadata:(0,ee.yx)(),type:"single-choice"}})),[4,U({message:t})];case 2:if(!(n=s.sent()))return[3,4];return r={address:O,msg:t,sig:n},[4,(0,ee.Jl)(r)];case 3:return a=s.sent(),K("/voting/proposal/".concat(a.ipfsHash)),er(L("Proposal created!")),[3,5];case 4:ea(L("Error"),L("Unable to sign payload")),s.label=5;case 5:return[3,7];case 6:return o=s.sent(),ea(L("Error"),null==o?void 0:o.message),console.error(o),Y(!1),[3,7];case 7:return[2]}})}),function(t){return e.apply(this,arguments)}),eZ=function(e,t){T(function(n){return(0,i.Z)((0,c.Z)({},n),(0,a.Z)({},e,t))}),V(function(t){return(0,i.Z)((0,c.Z)({},t),(0,a.Z)({},e,!0))})},eC=function(e){var t,n=e.currentTarget;eZ(n.name,n.value)},eT=function(e){eZ("body",e)},ew=function(e){eZ("choices",e)},eD=function(e){return function(t){eZ(e,t)}},eP=(0,l.useMemo)(function(){return{hideIcons:O&&ey.F_.includes(O.toLowerCase())?[]:["guide","fullscreen","preview","side-by-side","image"]}},[O]);return(0,l.useEffect)(function(){J>0&&T(function(e){return(0,i.Z)((0,c.Z)({},e),{snapshot:J})})},[J,T]),(0,d.jsxs)(M.Z,{py:"40px",children:[(0,d.jsx)(Q.V,{}),(0,d.jsx)(h.Z,{mb:"48px",children:(0,d.jsxs)(m.Z,{children:[(0,d.jsx)(W(),{href:"/",children:L("Home")}),(0,d.jsx)(W(),{href:"/voting",children:L("Voting")}),(0,d.jsx)(x.Z,{children:L("Make a Proposal")})]})}),(0,d.jsx)("form",{onSubmit:eb,children:(0,d.jsxs)(et.Z,{children:[(0,d.jsxs)(h.Z,{children:[(0,d.jsxs)(h.Z,{mb:"24px",children:[(0,d.jsx)(eo,{htmlFor:"name",children:L("Title")}),(0,d.jsx)(f.Z,{id:"name",name:"name",value:ei,scale:"lg",onChange:eC,required:!0}),eg.name&&N.name&&(0,d.jsx)(el,{errors:eg.name})]}),(0,d.jsxs)(h.Z,{mb:"24px",children:[(0,d.jsx)(eo,{htmlFor:"body",children:L("Content")}),(0,d.jsx)(x.Z,{color:"textSubtle",mb:"8px",children:L("Tip: write in Markdown!")}),(0,d.jsx)(eI,{id:"body",name:"body",onTextChange:eT,value:ed,options:eP,required:!0}),eg.body&&N.body&&(0,d.jsx)(el,{errors:eg.body})]}),ed&&(0,d.jsx)(h.Z,{mb:"24px",children:(0,d.jsxs)(_.Z,{children:[(0,d.jsx)(k.Z,{children:(0,d.jsx)(g.Z,{as:"h3",scale:"md",children:L("Preview")})}),(0,d.jsx)(b.Z,{p:"0",px:"24px",children:(0,d.jsx)($.Z,{children:ed})})]})}),(0,d.jsx)(ek,{choices:eu,onChange:ew}),eg.choices&&N.choices&&(0,d.jsx)(el,{errors:eg.choices})]}),(0,d.jsx)(h.Z,{children:(0,d.jsxs)(_.Z,{children:[(0,d.jsx)(k.Z,{children:(0,d.jsx)(g.Z,{as:"h3",scale:"md",children:L("Actions")})}),(0,d.jsxs)(b.Z,{children:[(0,d.jsxs)(h.Z,{mb:"24px",children:[(0,d.jsx)(es,{children:L("Start Date")}),(0,d.jsx)(G,{name:"startDate",onChange:eD("startDate"),selected:ep,placeholderText:"YYYY/MM/DD"}),eg.startDate&&N.startDate&&(0,d.jsx)(el,{errors:eg.startDate})]}),(0,d.jsxs)(h.Z,{mb:"24px",children:[(0,d.jsx)(es,{children:L("Start Time")}),(0,d.jsx)(R,{name:"startTime",onChange:eD("startTime"),selected:eh,placeholderText:"00:00"}),eg.startTime&&N.startTime&&(0,d.jsx)(el,{errors:eg.startTime})]}),(0,d.jsxs)(h.Z,{mb:"24px",children:[(0,d.jsx)(es,{children:L("End Date")}),(0,d.jsx)(G,{name:"endDate",onChange:eD("endDate"),selected:em,placeholderText:"YYYY/MM/DD"}),eg.endDate&&N.endDate&&(0,d.jsx)(el,{errors:eg.endDate})]}),(0,d.jsxs)(h.Z,{mb:"24px",children:[(0,d.jsx)(es,{children:L("End Time")}),(0,d.jsx)(R,{name:"endTime",onChange:eD("endTime"),selected:ex,placeholderText:"00:00"}),eg.endTime&&N.endTime&&(0,d.jsx)(el,{errors:eg.endTime})]}),O&&(0,d.jsxs)(Z.Z,{alignItems:"center",mb:"8px",children:[(0,d.jsx)(x.Z,{color:"textSubtle",mr:"16px",children:L("Creator")}),(0,d.jsx)(j.Z,{href:(0,S.C)(O,"address"),children:(0,E.Z)(O)})]}),(0,d.jsxs)(Z.Z,{alignItems:"center",mb:"16px",children:[(0,d.jsx)(x.Z,{color:"textSubtle",mr:"16px",children:L("Snapshot")}),(0,d.jsx)(j.Z,{href:(0,S.C)(ef,"block"),children:ef})]}),O?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(v.Z,{type:"submit",width:"100%",isLoading:A,endIcon:A?(0,d.jsx)(y.Z,{spin:!0,color:"currentColor"}):null,disabled:!P()(eg),mb:"16px",children:L("Publish")}),(0,d.jsxs)(x.Z,{color:"failure",as:"p",mb:"4px",children:[L("You need at least %count% voting power to publish a proposal.",{count:ey.V5})," "]}),(0,d.jsx)(v.Z,{scale:"sm",type:"button",variant:"text",onClick:ec,p:0,children:L("Check voting power")})]}):(0,d.jsx)(z.Z,{width:"100%",type:"button"})]})]})})]})}),(0,d.jsx)(H,{})]})}}},function(e){e.O(0,[2298,6600,3577,4297,7492,9774,2888,179],function(){return e(e.s=42379)}),_N_E=e.O()}]);